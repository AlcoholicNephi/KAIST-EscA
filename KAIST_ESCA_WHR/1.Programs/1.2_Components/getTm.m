function [Tm] = getTm(Ph, Pc, m)

% getTm with Neural Network
% # of Layers : 300
% Method : Levenberg - Marquardt
% MSE 8.8763E-4 / R 0.999999
%
% Ph : Hot side pressure (kPa)
% Pc : Cold side pressure (kPa)
% m  : mass fraction, m_c/m_h
% Tm : Pinch Temperature when pinch point is 0 K

mfrac_bound = [0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.520000000000000;0.520000000000000;0.520000000000000;0.520000000000000;0.520000000000000;0.520000000000000;0.520000000000000;0.520000000000000;0.520000000000000;0.520000000000000;0.520000000000000;0.520000000000000;0.520000000000000;0.520000000000000;0.520000000000000;0.520000000000000;0.520000000000000;0.520000000000000;0.520000000000000;0.520000000000000;0.520000000000000;0.520000000000000;0.520000000000000;0.520000000000000;0.540000000000000;0.540000000000000;0.540000000000000;0.540000000000000;0.540000000000000;0.540000000000000;0.540000000000000;0.540000000000000;0.540000000000000;0.540000000000000;0.540000000000000;0.540000000000000;0.540000000000000;0.540000000000000;0.540000000000000;0.540000000000000;0.540000000000000;0.540000000000000;0.540000000000000;0.540000000000000;0.540000000000000;0.540000000000000;0.540000000000000;0.540000000000000;0.560000000000000;0.560000000000000;0.560000000000000;0.560000000000000;0.560000000000000;0.560000000000000;0.560000000000000;0.560000000000000;0.560000000000000;0.560000000000000;0.560000000000000;0.560000000000000;0.560000000000000;0.560000000000000;0.560000000000000;0.560000000000000;0.560000000000000;0.560000000000000;0.560000000000000;0.560000000000000;0.560000000000000;0.560000000000000;0.560000000000000;0.560000000000000;0.580000000000000;0.580000000000000;0.580000000000000;0.580000000000000;0.580000000000000;0.580000000000000;0.580000000000000;0.580000000000000;0.580000000000000;0.580000000000000;0.580000000000000;0.580000000000000;0.580000000000000;0.580000000000000;0.580000000000000;0.580000000000000;0.580000000000000;0.580000000000000;0.580000000000000;0.580000000000000;0.580000000000000;0.580000000000000;0.580000000000000;0.580000000000000;0.600000000000000;0.600000000000000;0.600000000000000;0.600000000000000;0.600000000000000;0.600000000000000;0.600000000000000;0.600000000000000;0.600000000000000;0.600000000000000;0.600000000000000;0.600000000000000;0.600000000000000;0.600000000000000;0.600000000000000;0.600000000000000;0.600000000000000;0.600000000000000;0.600000000000000;0.600000000000000;0.600000000000000;0.600000000000000;0.600000000000000;0.600000000000000;0.620000000000000;0.620000000000000;0.620000000000000;0.620000000000000;0.620000000000000;0.620000000000000;0.620000000000000;0.620000000000000;0.620000000000000;0.620000000000000;0.620000000000000;0.620000000000000;0.620000000000000;0.620000000000000;0.620000000000000;0.620000000000000;0.620000000000000;0.620000000000000;0.620000000000000;0.620000000000000;0.620000000000000;0.620000000000000;0.620000000000000;0.620000000000000;0.640000000000000;0.640000000000000;0.640000000000000;0.640000000000000;0.640000000000000;0.640000000000000;0.640000000000000;0.640000000000000;0.640000000000000;0.640000000000000;0.640000000000000;0.640000000000000;0.640000000000000;0.640000000000000;0.640000000000000;0.640000000000000;0.640000000000000;0.640000000000000;0.640000000000000;0.640000000000000;0.640000000000000;0.640000000000000;0.640000000000000;0.640000000000000;0.660000000000000;0.660000000000000;0.660000000000000;0.660000000000000;0.660000000000000;0.660000000000000;0.660000000000000;0.660000000000000;0.660000000000000;0.660000000000000;0.660000000000000;0.660000000000000;0.660000000000000;0.660000000000000;0.660000000000000;0.660000000000000;0.660000000000000;0.660000000000000;0.660000000000000;0.660000000000000;0.660000000000000;0.660000000000000;0.660000000000000;0.660000000000000;0.680000000000000;0.680000000000000;0.680000000000000;0.680000000000000;0.680000000000000;0.680000000000000;0.680000000000000;0.680000000000000;0.680000000000000;0.680000000000000;0.680000000000000;0.680000000000000;0.680000000000000;0.680000000000000;0.680000000000000;0.680000000000000;0.680000000000000;0.680000000000000;0.680000000000000;0.680000000000000;0.680000000000000;0.680000000000000;0.680000000000000;0.680000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.700000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.720000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.740000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.760000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.780000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.800000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.820000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.840000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.860000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.880000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.900000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.920000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.940000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.960000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;0.980000000000000;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1.02000000000000;1.02000000000000;1.02000000000000;1.02000000000000;1.02000000000000;1.02000000000000;1.02000000000000;1.02000000000000;1.02000000000000;1.02000000000000;1.02000000000000;1.02000000000000;1.02000000000000;1.02000000000000;1.02000000000000;1.02000000000000;1.02000000000000;1.02000000000000;1.02000000000000;1.02000000000000;1.02000000000000;1.02000000000000;1.02000000000000;1.02000000000000;1.04000000000000;1.04000000000000;1.04000000000000;1.04000000000000;1.04000000000000;1.04000000000000;1.04000000000000;1.04000000000000;1.04000000000000;1.04000000000000;1.04000000000000;1.04000000000000;1.04000000000000;1.04000000000000;1.04000000000000;1.04000000000000;1.04000000000000;1.04000000000000;1.04000000000000;1.04000000000000;1.04000000000000;1.04000000000000;1.04000000000000;1.04000000000000;1.06000000000000;1.06000000000000;1.06000000000000;1.06000000000000;1.06000000000000;1.06000000000000;1.06000000000000;1.06000000000000;1.06000000000000;1.06000000000000;1.06000000000000;1.06000000000000;1.06000000000000;1.06000000000000;1.06000000000000;1.06000000000000;1.06000000000000;1.06000000000000;1.06000000000000;1.06000000000000;1.06000000000000;1.06000000000000;1.06000000000000;1.06000000000000;1.08000000000000;1.08000000000000;1.08000000000000;1.08000000000000;1.08000000000000;1.08000000000000;1.08000000000000;1.08000000000000;1.08000000000000;1.08000000000000;1.08000000000000;1.08000000000000;1.08000000000000;1.08000000000000;1.08000000000000;1.08000000000000;1.08000000000000;1.08000000000000;1.08000000000000;1.08000000000000;1.08000000000000;1.08000000000000;1.08000000000000;1.08000000000000;1.10000000000000;1.10000000000000;1.10000000000000;1.10000000000000;1.10000000000000;1.10000000000000;1.10000000000000;1.10000000000000;1.10000000000000;1.10000000000000;1.10000000000000;1.10000000000000;1.10000000000000;1.10000000000000;1.10000000000000;1.10000000000000;1.10000000000000;1.10000000000000;1.10000000000000;1.10000000000000;1.10000000000000;1.10000000000000;1.10000000000000;1.10000000000000;1.12000000000000;1.12000000000000;1.12000000000000;1.12000000000000;1.12000000000000;1.12000000000000;1.12000000000000;1.12000000000000;1.12000000000000;1.12000000000000;1.12000000000000;1.12000000000000;1.12000000000000;1.12000000000000;1.12000000000000;1.12000000000000;1.12000000000000;1.12000000000000;1.12000000000000;1.12000000000000;1.12000000000000;1.12000000000000;1.12000000000000;1.12000000000000;1.14000000000000;1.14000000000000;1.14000000000000;1.14000000000000;1.14000000000000;1.14000000000000;1.14000000000000;1.14000000000000;1.14000000000000;1.14000000000000;1.14000000000000;1.14000000000000;1.14000000000000;1.14000000000000;1.14000000000000;1.14000000000000;1.14000000000000;1.14000000000000;1.14000000000000;1.14000000000000;1.14000000000000;1.14000000000000;1.14000000000000;1.14000000000000;1.16000000000000;1.16000000000000;1.16000000000000;1.16000000000000;1.16000000000000;1.16000000000000;1.16000000000000;1.16000000000000;1.16000000000000;1.16000000000000;1.16000000000000;1.16000000000000;1.16000000000000;1.16000000000000;1.16000000000000;1.16000000000000;1.16000000000000;1.16000000000000;1.16000000000000;1.16000000000000;1.16000000000000;1.16000000000000;1.16000000000000;1.16000000000000;1.18000000000000;1.18000000000000;1.18000000000000;1.18000000000000;1.18000000000000;1.18000000000000;1.18000000000000;1.18000000000000;1.18000000000000;1.18000000000000;1.18000000000000;1.18000000000000;1.18000000000000;1.18000000000000;1.18000000000000;1.18000000000000;1.18000000000000;1.18000000000000;1.18000000000000;1.18000000000000;1.18000000000000;1.18000000000000;1.18000000000000;1.18000000000000;1.20000000000000;1.20000000000000;1.20000000000000;1.20000000000000;1.20000000000000;1.20000000000000;1.20000000000000;1.20000000000000;1.20000000000000;1.20000000000000;1.20000000000000;1.20000000000000;1.20000000000000;1.20000000000000;1.20000000000000;1.20000000000000;1.20000000000000;1.20000000000000;1.20000000000000;1.20000000000000;1.20000000000000;1.20000000000000;1.20000000000000;1.20000000000000];
Ph_bound = [7000;7400;7850;8250;8600;8600;8450;8200;8050;7750;7450;7100;6800;6350;6000;6000;6000;6000;6000;6000;6000;6000;6000;6000;7000;7500;7950;8350;8700;8750;8650;8450;8350;8100;7850;7550;7250;6900;6600;6250;6000;6000;6000;6000;6000;6000;6000;6000;7000;7550;8000;8450;8850;8900;8800;8750;8650;8450;8200;8000;7650;7400;7100;6800;6500;6200;6000;6000;6000;6000;6000;6000;7000;7600;8100;8550;8950;9050;9000;9000;8900;8750;8550;8350;8100;7850;7600;7350;7100;6800;6550;6300;6000;6000;6000;6000;7000;7600;8150;8650;9050;9200;9100;9200;9150;9050;8900;8700;8500;8300;8100;7850;7650;7400;7100;6900;6650;6400;6150;6000;7000;7650;8200;8750;9150;9350;9300;9400;9400;9350;9250;9050;8900;8750;8550;8350;8150;7900;7700;7500;7250;7050;6850;6600;7000;7700;8250;8800;9200;9450;9550;9600;9650;9600;9500;9400;9300;9150;9000;8850;8650;8450;8300;8100;7900;7700;7500;7300;7000;7700;8300;8900;9300;9600;9700;9800;9850;9900;9800;9750;9700;9600;9450;9300;9150;9000;8850;8700;8500;8300;8150;7950;7000;7750;8350;8950;9400;9700;9850;10000;10100;10100;10100;10100;10050;9950;9850;9750;9650;9550;9400;9250;9100;8950;8800;8650;7000;7750;8400;9050;9450;9850;10000;10200;10350;10350;10400;10450;10400;10350;10300;10250;10150;10050;9950;9800;9700;9600;9450;9300;7000;7800;8450;9100;9550;9950;10150;10350;10500;10600;10700;10750;10750;10750;10750;10700;10650;10550;10500;10400;10300;10200;10100;10000;7000;7800;8500;9150;9600;10050;10300;10550;10700;10850;11000;11050;11100;11150;11200;11150;11150;11100;11050;11000;10900;10850;10750;10700;7000;7850;8550;9200;9700;10100;10400;10750;10900;11100;11300;11400;11500;11550;11600;11600;11650;11650;11600;11600;11550;11500;11450;11400;7000;7850;8600;9250;9750;10200;10550;10900;11150;11400;11550;11700;11850;11950;12050;12100;12150;12200;12200;12200;12200;12200;12150;12100;7000;7900;8650;9250;9850;10300;10700;11050;11350;11600;11850;12050;12200;12350;12500;12600;12650;12750;12800;12850;12850;12850;12850;12850;7000;7900;8650;9350;9950;10350;10850;11200;11600;11850;12150;12400;12600;12800;12950;13050;13200;13300;13400;13450;13550;13600;13650;13650;7000;7900;8700;9400;9950;10500;10950;11400;11750;12150;12450;12700;13000;13200;13400;13600;13750;13900;14050;14150;14250;14350;14400;14500;7000;7900;8750;9450;10000;10600;11100;11550;12000;12400;12700;13100;13350;13650;13900;14100;14300;14550;14700;14850;15000;15150;15250;15350;7000;7950;8750;9500;10100;10650;11250;11750;12200;12650;13050;13400;13800;14100;14400;14700;14900;15150;15400;15600;15800;16000;16150;16300;7000;7950;8750;9500;10150;10800;11400;11900;12450;12900;13400;13750;14200;14550;14900;15250;15550;15850;16150;16400;16650;16900;17100;17300;7000;7950;8800;9500;10250;10900;11550;12100;12650;13150;13700;14150;14650;15050;15500;15850;16200;16600;16950;17250;17550;17850;18150;18400;7000;7950;8800;9550;10300;11000;11600;12250;12900;13400;14000;14500;15050;15550;16000;16500;16900;17350;17750;18150;18550;18950;19300;19650;7000;7950;8800;9600;10350;11050;11750;12400;13000;13650;14250;14900;15450;16000;16600;17100;17600;18150;18650;19150;19600;20050;20500;20950;6900;7950;8750;9500;10200;10950;11600;12300;13000;13700;14400;15050;15700;16350;17000;17650;18250;18900;19500;20100;20700;21250;21850;22400;7000;7900;8700;9500;10250;11000;11750;12450;13200;13900;14600;15300;16050;16850;17650;18400;19200;20000;20750;21500;22300;23050;23800;24500;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;9950;10900;11850;12800;13750;14700;15650;16550;17500;18400;19350;20250;21150;22100;23000;23900;24800;25700;26600;27450;28350;7000;8000;8950;9900;10800;11700;12600;13500;14400;15300;16150;17000;17900;18750;19550;20400;21250;22050;22900;23700;24500;25300;26100;26900;7000;8000;8900;9800;10700;11600;12450;13300;14150;14950;15750;16600;17400;18150;18950;19700;20500;21250;22000;22750;23450;24200;24900;25650;7000;8000;8900;9750;10600;11450;12250;13100;13850;14650;15400;16200;16900;17650;18400;19100;19800;20500;21200;21850;22550;23200;23850;24500;7000;7950;8850;9700;10500;11300;12100;12900;13650;14350;15100;15800;16500;17200;17850;18550;19200;19850;20450;21100;21700;22300;22900;23500;7000;7950;8800;9650;10450;11200;11950;12700;13400;14100;14800;15450;16100;16750;17400;18000;18600;19200;19800;20350;20950;21500;22050;22600;7000;7950;8800;9600;10350;11100;11800;12500;13200;13850;14500;15150;15750;16350;16950;17550;18100;18650;19200;19750;20250;20750;21250;21750;7000;7950;8750;9500;10250;11000;11650;12350;13000;13650;14250;14850;15400;16000;16550;17100;17600;18150;18650;19150;19600;20100;20550;21000;7000;7950;8700;9450;10200;10900;11550;12200;12800;13400;14000;14550;15100;15650;16150;16700;17150;17650;18150;18600;19050;19500;19900;20350;7000;7900;8700;9400;10100;10800;11400;12050;12650;13200;13750;14300;14800;15350;15800;16300;16750;17200;17650;18100;18500;18900;19300;19700];
Pc_bound = [7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000;7000;8000;9000;10000;11000;12000;13000;14000;15000;16000;17000;18000;19000;20000;21000;22000;23000;24000;25000;26000;27000;28000;29000;30000];

Bound_Test = scatteredInterpolant(Pc_bound, mfrac_bound, Ph_bound);

MaximumPh = Bound_Test(Pc, m);

if(MaximumPh <= Ph)
    Tm = -1;
else
    
    x1 = [Pc;Ph;m];
    % ===== NEURAL NETWORK CONSTANTS =====
    
    % Input 1
    x1_step1_xoffset = [7000;6000;0.5];
    x1_step1_gain = [8.69565217391304e-05;8.35073068893528e-05;2.85714285714286];
    x1_step1_ymin = -1;
    
    % Layer 1
    b1 = [8.4254747749451813;8.0674768381902791;-7.7295155531832052;-7.5637309168530482;-6.9281093116681305;8.5628607451836487;-5.7017237163251506;5.075120806729057;10.158315356438305;5.8258902216669277;-8.4807782537934226;6.1386490370093973;-7.9673374973243716;5.5383826412929151;-10.416454113094785;-8.0841312742623543;-8.1164639773770535;-7.5162438542641361;-9.1964561325990388;-7.4741275559223386;6.8675240642084416;7.781468033493824;6.4293559439081776;-8.1851243027093421;8.0912485252635484;7.0898925523226515;7.2406883430610245;5.9974270073357809;7.3532444681619227;2.0570371765101774;-5.4374470086855782;-5.5577164748266581;-2.6298839934942131;7.1989715298842585;5.1326871419628919;-8.069182963280042;-4.3110119961509881;-8.0522183722008034;4.7431109663161362;-7.196143384396481;5.4368263228267821;5.5788705288224181;6.1100726653947959;4.9942317162625436;5.127638094917315;-7.1830313634747158;6.1272255916359173;6.7088580112751446;-4.3202861890897228;-6.8028198411395451;5.6507673586259957;6.9992319483326249;-4.309723953131928;-6.4220617492813927;-5.1715288466149172;6.8697000249503226;5.9711838582817522;-4.8366332673025667;-3.9750644225263461;5.4806054833345907;-3.8594778348723686;5.9641084199636492;3.9070744987725026;-1.981127762824443;-5.4993215921772176;4.2571102978377811;1.7345825406935307;-3.3022981318746587;4.3759185521425241;5.299512116577378;4.0283956167641497;-5.7170289831735017;-6.2043196329269996;-4.6500567191277229;2.905111126965513;-2.8598587762640642;5.2224863503591461;-5.3282355214534673;4.7020454225960062;-2.8798908092608997;4.1254742872796681;3.1312552349870248;-3.9589500286082684;2.26849727143032;-1.6782108338772439;3.4010387842040744;-2.0382238488615037;4.1131236964969426;-1.8787938780633426;4.1117955032288078;-1.7421793631721454;-1.9949440898071098;0.99977652858704857;-3.344490798259725;-4.2009802040278661;-2.6595644782647381;2.876008482489774;-2.8433836782478097;-1.7825838735883215;0.81437526303840602;3.2750367112732648;-1.7402863242586055;-1.3147208268534547;1.8205387053136988;2.9730571144672964;-2.6902618740872097;-2.1052265193497757;-2.8348254902585532;-2.6655268369872069;2.2517481074610566;-2.1403745304101927;3.5552047328563239;-3.9004583646228093;-0.44786435731301005;-2.8900838750793598;-3.0534186578916844;0.3606940883611624;1.6071515019401088;1.6974209798838862;-1.1583479215691317;-1.6471413110432727;-3.3703748005923204;-2.1026845294690442;-0.40140132714705068;-0.64584476387797818;-3.3918466648137797;-0.78690302069481644;-0.68264106675052583;-1.7606977309183038;-1.6025719398583309;1.7535326698012927;-2.7191410965878315;0.20925054712758134;-2.2513766794398182;1.006178666538903;-1.9614164574588513;-1.0916198225035265;1.5958423044154273;-0.39091084502333945;1.6415783838493898;0.71072028428691991;-1.6428672385113616;2.9065664743555333;-2.6896778042800147;0.2472333810529305;-1.3263523038224034;-0.7416931063919262;-0.47472466185520268;-1.4748384435889914;-0.64671938169132659;1.0857980161937313;1.7164965549580995;0.18168915709681041;-1.0676106645800807;0.4210642916466662;-0.69319154578079456;1.8263326584442818;-0.55237588580302055;0.70940910954428549;-0.75286816244597143;-0.13600208314960852;-2.5033999338743054;-1.1870615220527483;-1.018275228374014;0.59205997607779182;-2.7080871699046645;-0.37448408632960828;-1.2974102276158577;0.95960899257259558;-1.8897933522131642;-0.97700505522046566;0.33132631102861765;-2.1213650154666701;-0.90271129132661843;-0.38063431382590074;2.4207887312031655;1.8453213470788383;-3.7481566380373388;1.7276117001199067;-6.4643442258391266;-2.6242853785262676;2.9878278831808252;-2.2036755069319827;3.2689605123556871;-1.0915484437544942;2.5787643055082121;-1.1737788429310199;-2.4624517336125331;-1.6511435461983488;2.9594445114964678;1.659073547180109;0.79720509597223277;2.3635860544166194;-3.2305433002070103;-1.9460618901007702;1.2809870187325854;2.4170206654021014;1.500495747079811;0.021896079314194888;2.4765980795868714;-2.765326742368754;-1.1115517332122158;-2.916071895972177;-1.3970910560057093;2.7516912304918866;4.378648590430906;2.8653984498258702;-2.6901678873150834;-2.992498467476453;-1.8448237272360319;-3.041305912948967;-2.9260560547997567;4.4128748846796952;3.4543632638538075;-3.2100204416439801;4.0966384137981136;5.1493364748115464;3.9428171557452396;-2.6293902251445429;3.3923807953039047;4.4701060271198205;-2.4542872177801711;3.7843925929147781;-3.3847246763557819;4.4853926902099763;4.2888365962002775;-5.3801411501434782;6.4151624582841755;4.4036797068886795;-1.67312565668158;2.58761781620903;-5.2799019442026287;2.5293115653477156;-4.9307844521997524;-4.55624118870373;5.7164966539802426;5.8993044506226147;-5.1532054612956637;-4.7290240925973972;4.0387657672079023;5.4827604974294362;6.1453633460702477;-6.1178679565563669;-7.7249957583253073;6.0453762301318354;-2.7556590073165514;6.3834473357639272;-6.6369419774123406;-5.6900370162204235;4.1244843431321945;-2.8672426414730028;5.430858967305352;-7.4455974514007286;6.7340855392949086;4.2301417577521878;7.1191441355318652;6.6106802829154718;5.0617108164620088;-7.0435368407614511;-4.2255467213208515;6.8240226309162413;-6.5683033792719128;-6.7104872035421383;6.2757963855836589;7.1779257105928265;-7.2406011063953493;3.5654131225721915;7.3659222496353811;7.075928259614674;-6.1622732475057855;6.3536187867232261;7.6171050263789324;6.0160128478504467;8.2307267551602195;-7.8046380387187408;-8.3325414559415982;2.5362600791291783;-7.9929415264420145;-7.5313212802204168;8.1848945353255456;-8.2411851296847889;7.4429013440202727;9.0888553342538057;8.3683672514940195;-8.7781247837817578;8.4970796267335764;8.0180785047444019;-8.677208387547946;6.6393889281474259;-8.3364793622863971;8.0736375741531514;-8.6556829076834276;-7.7733433542648198;-8.4150838621266857;-8.9552375211323092;7.7944752807600102;-9.184052068398767;8.1513997081262879;8.905805094103636;-9.385914819499563];
    IW1_1 = [-3.025979834951801 2.7035605711325092 7.4817500211090628;-3.2296580752809891 -4.6127417304493621 11.456382566820382;5.3503825779629537 6.0412433303018318 2.1960369662820836;1.1530797031867595 -6.8929478105057953 0.35447382789694981;4.9739398324578117 4.6167853925551237 -6.5805055774471697;-6.5787584811598929 -8.4848093656561616 8.7096786640244392;1.5067548624376546 -5.080284937234965 -2.418308640450674;-4.3611880020040594 -5.2476294778904373 5.4610771908949962;-1.668663542275771 2.4633052226382435 8.6674448484265483;-0.31241909304019749 4.7482903522455588 -0.1069792346021696;3.3146954146372849 -7.3029420380941161 3.7470555764483997;-6.0489357025808443 1.3890647560953966 -2.2081150090140111;6.3602430031877359 5.3346936453236706 3.3175766599404399;-1.3638066461038658 4.6589695115273679 -2.0502574886979792;10.12281752624258 -0.30499801862148018 0.52802321412486297;5.4843179881521724 6.6007883667017184 -4.4394587632725067;2.5232750605067618 -6.3911405020982635 -5.3874366618940286;3.2083722022868968 -7.0563392959896234 3.8738168092618426;1.065116268471866 -5.0128763618548833 -6.1423270948254682;6.3840390612455513 -4.8046620017458004 4.1497164034643941;-6.7507672171614379 0.70242127488318051 -1.2710709858680065;-8.178645588762004 4.0022084635089259 -2.8199226647674518;-1.1393588667164369 6.7465000589973743 -0.24776534956808463;3.8837792567079714 6.1743655271818429 -0.093095472074858021;-2.3056807962579047 -4.0147499544334782 8.0348554586428804;-6.0075864187050003 4.1985240611846768 -4.3193279378623535;-7.2174607623367741 5.4987420734085974 -1.0688217790283157;-4.7590503110200197 -8.3849427208729033 10.479650793347663;-1.2742203395987821 -9.1500291743836843 0.91177965163264829;0.41515056097456671 3.7142264423722158 -0.33384965224646401;1.5931673381366185 -5.9287982639143557 -1.8438042381340514;2.2580412055553878 9.8531955098281685 -1.7251370930078849;0.010507434197975398 -5.5047163157552861 2.110040523635043;-0.89548079079247223 3.5539115009402247 7.0833630303814665;-5.1119545907889563 0.28110603369834791 -6.711705153988774;3.5898390090655905 8.4278403623666822 -0.68408487245044847;1.6537870487587925 -7.3232564181234441 2.5734852200887044;4.2619068102292896 -3.8048445916377962 -4.5684372402196862;-1.639426339824912 5.0964100297394097 -5.2736725438886092;2.8269296252892824 5.0684099970046077 -7.2123871479184158;-7.8785332087427662 -2.2143891032623189 0.36867688505571211;-2.9396968057960517 -4.7763374534778453 9.6727168612014705;-4.1231407431090972 -7.8914604343623971 -1.5250047452348205;-3.9767565815601489 -8.4624100441385384 11.249380687436561;-2.9631165450710624 -5.6766776379220723 9.5618632500958203;6.1868037042166728 1.8308598029340377 -5.8545198976220831;-2.3685363814585552 0.51127268626053002 8.9213040854627721;0.38652333294962388 -9.1829617742116714 5.5449415142497767;3.650320723520065 7.8952204279139835 4.2088791237489493;3.3044030222379153 -7.8601653776285563 3.4303068855691254;-0.17707574429484632 5.8159099180436282 -6.3437438516471669;-6.3386636902327789 -4.1806404180555923 -3.7306175688411374;4.5984378481930266 -3.1909400601101585 6.828604502084727;2.8440622330695886 -2.9178329129746312 -7.8161525960845148;6.8430735269721517 0.39434317911449013 3.7393417006776324;-7.6507778240686086 1.5927540979361088 4.2335955639233305;-2.5918987128421231 5.0388190155639547 5.3284090890046434;1.0661968603304899 7.2388843366162172 -3.3360739082958974;3.5308268670327263 6.4837132599001359 -7.4507976330263936;-3.2740374639273351 -8.5642944035457855 -2.8790854072942786;2.5917166811846619 -4.2490387316615656 4.2753736185826732;-7.9688282953333456 3.5884304625150887 -2.2340451546259512;-1.4441485748061083 5.4112683553498879 -5.844112750658593;2.7834843852536131 0.49099828831803272 6.188182529625073;2.4949045025854333 8.4258021081835608 0.90271493487963905;-3.0802773189376831 4.782643691352364 -4.4911716890809226;-1.2037576231539542 4.3950425453662429 -2.600326351617646;1.0482756623168379 -4.1267079980069301 -0.27662158215506799;-4.6378567373192379 3.2565356885265233 -6.8930454935052081;-6.7134449446346842 -6.1609742819424067 -0.28247728934307276;-2.4285926934738007 7.1208657335141963 -5.327654055021374;6.5348453064178482 -2.898679420372213 -4.6091369027194036;6.6674088577741095 2.9811731134890738 -1.6496328471665456;6.2868182262956775 2.3791218394918352 4.9680685120537156;-3.3388583706466162 -4.4678087057035851 3.1018230740819352;2.8726847912532718 6.7798636703260051 -6.8251843783947148;-2.9466794039974444 5.4628826968250292 5.5397034855980722;6.1750580720143482 2.7355171293970417 4.4859118508731326;-6.6663550649532572 3.3316673960301686 3.9999527394284384;1.3745859623612102 7.3825719990592882 0.10455221024728314;-6.9502053513604904 -5.3816696975965623 0.36763225724366128;-8.2592214430412003 2.0971880604446871 4.7557194565976131;5.9354381219510088 6.6681236863517075 1.833286214330117;-3.4297924200741798 0.78448861046231855 -7.3138861389124852;3.063550840424075 -2.6423928324703678 6.5980038116670929;-6.4130385906606691 5.2368886215247166 2.3828295859730524;4.8766888692744566 7.1560681930311709 -4.5244672649920137;-4.5725097247861139 1.1976840999405134 -6.1067412231952751;2.1532550472481709 -3.9496408636211036 5.2091770216934927;-3.4828106134042169 7.5193312493631366 0.22060594015335838;6.7246345853835763 -6.5687958439051375 0.11727868727752515;4.3816940793751256 1.0061413287774106 0.27440512054938199;-0.88680599948758376 -5.6117357433074302 0.42386698398688732;5.0235655686569887 -4.5194857214469595 -5.9000308347611199;7.2049261888039764 1.7411123794998 -0.055370689144016515;6.0845353675254019 -5.6179974777095891 -1.5187994932417421;-8.6626470978637631 1.9171872653595416 2.0641015767640525;3.5880557213140944 -5.9680886086746856 -5.8253372525460767;1.9344566922419657 2.7098384549768579 5.2438413390746899;-2.4000954127939784 -5.418600753996297 5.4866053848103054;-6.7905274635561081 -1.6046383992274598 -3.8200734056666286;1.8346285542369485 6.3619681055896429 -7.0650446348985723;0.957789878794709 -3.7573295714792572 6.2993232018496164;-1.2937497260594335 -3.0654319037242965 -4.512889930338293;-8.1524579615454389 -2.8663575389065596 2.2363257205919154;2.1589858453830773 -4.9621704992432178 -7.2075976291379495;5.7236811402611423 -4.7219919638159533 -5.5308410647075172;4.7152745221209624 -1.3982389134653956 6.6717114078773845;0.67403086758135766 0.30879561084049451 -7.0339883742652143;-4.5689549521542157 4.1479588624627777 -5.0636006696155986;3.5328267317139859 -1.9330139844491347 7.4796146975508568;-1.953122520026954 5.3699749949856139 0.27436813466617199;1.3275076289865428 -2.5567661473172811 -8.2463435333861828;3.1825070816319183 5.1633404461708823 -3.451122361029388;4.2797241502324237 2.8577388360888505 -6.3771841015148718;5.7513272009638916 2.8143505823635078 -5.844926251660695;-0.58128496911841787 -3.6030422264000213 -0.48147972527313293;-6.6573946280982552 -2.3040083172080714 -4.0131189743779299;-1.6016011187906738 5.6475800169424248 -5.4222632830269619;2.2975600312536839 7.024830412572121 4.4230424341434347;8.3960632447946733 -1.1686334016097071 -4.3103927636307624;3.0329673958270087 6.9851868397401677 -8.4560742452026361;6.1426399231145625 -6.1856782597658349 -0.91080849477422343;0.35923614146937399 -5.6684166326415379 5.2430453769916614;-2.2048018336660102 -3.2231582202107165 1.529361015920123;5.7398833816279815 2.0242813334898258 4.9944988475091101;2.975068552017551 7.8832368984951096 3.0723865880881074;2.3006468721173401 5.446852747757708 -5.5987194081552163;2.1510868840486275 -3.7883165208989324 5.1721235761259807;6.2225067751095313 -2.0088563978785672 3.5818843440360677;-2.315452414106125 -1.7786063136635992 -5.6698994960896725;6.5906135721232673 -1.9127280489930638 3.5499632179394078;2.419813733423974 3.8259492670926623 -2.3997635025089079;1.9125740830961782 -7.8286954311516839 -2.5513999962807281;-3.6007495478930771 -5.6400284991485554 -6.1565077186521808;3.1116296056371242 -6.8195826498746799 -4.9902503242402894;5.877411005443566 -2.6490911227399638 3.7845223440128462;-5.0138553766361467 -0.90115232397812506 7.50692444830376;5.1942699625597806 2.9037894423656314 -4.4897213448664601;-5.5017499823462845 6.0990286366896065 -3.8659141645533395;0.11784814548817354 5.1921873860935159 -1.8780584377165985;1.5120079718807464 -5.5030834040278025 5.3274573978727373;0.31645672347941145 6.1376595075394649 -0.98346618692707743;1.5357627700569154 -6.7020980270369295 -2.3989043825665655;0.91801158034503361 -0.80709801333209874 -9.2047401599122392;6.0179030394976403 -6.1442725349297351 -0.26156466465662753;4.8003078251468096 6.8408086906254333 2.1752640230831823;5.0894454505393236 -4.0245032123302877 6.1488273419223525;2.0641752934535451 -8.2595472937859444 -2.4886069954985981;0.56744583098996537 1.6563913841077027 -8.037893310040733;-5.1834528069849659 3.894789127492754 -3.9629210728810245;0.2273968620247391 6.1312019896396812 -1.5904223359793794;5.9403934965385226 -7.7418744402440085 0.97156614678678554;2.0198001143764102 -8.2313157117175102 -1.5280806941603169;2.4292682548174866 7.233142937311416 4.3175214906561923;-2.8413102639614176 -8.1433576616757914 -2.6479859194620174;7.5128628730953926 -4.2353203020776942 -0.65652784632742089;1.9275240066660551 -3.873347274944098 -6.9602517608968331;-3.6619834318672035 5.3007372394216858 6.3546761767637898;0.42410009525965153 3.9188353321037428 -6.6104673045241391;1.4843939396176158 -4.0449350741944379 4.3739641099186635;0.94787587705988885 -5.2036441936925275 -2.8220766005235798;0.35087973505678305 4.2886914151187412 3.9468778367215576;-7.7085723274407538 -2.5116462324293312 0.6413846146505493;-3.1738044276986819 -6.1149993850527986 5.2979829220170682;-1.4857880201484395 4.6410464062369945 -6.9828666012188139;-2.0550431974754972 6.3385387492956786 1.4407365065853905;0.97269017351493614 -3.7661845039843955 6.4058839774590544;-0.092831898780327146 4.990365704136055 -3.5101914964240755;-7.0110778598971679 3.7847396964885789 0.63432981119551446;-2.687670453759845 7.4983176587640932 1.291976644032758;4.3485797826018286 -6.6417666242287625 -0.45012158873055796;-0.44496852214648297 -3.9013361709399188 0.28080638417456227;-6.4828389466324108 7.3665086142741272 -1.1004204372416813;2.14009975221837 -3.3166096238687053 5.3676455054797145;1.2715970482714545 8.6236529734095821 0.61109385063094845;3.8351257972150639 4.2341851493797886 -3.6796084954485502;-0.54916894761213053 8.9871693094056404 -5.929342215104537;2.7581253696373733 3.7391964877416135 -1.5784169138283224;-10.524233664966859 4.4746772889384117 0.65942528808288392;-12.154131787970391 12.541426114823434 -0.45424587587125009;5.969248433567282 1.9478180486387795 -2.8374917908879254;-4.7254207199967562 -6.8244133798110651 2.8239829271001344;6.128660221567138 1.2761745717519093 -2.4829072226261242;0.092614619116815233 -5.1671688784786207 3.7751222795890813;5.7072818627987019 -1.113960808945067 -1.1267982208985834;-17.466779854529243 20.459151893097623 0.020678849307110714;-6.1543373900342795 -2.9288022170041579 -5.8322556767658016;-7.5866877574588392 7.9009584453870261 1.1205197642328319;5.1926487128855765 -4.3090358981169787 4.6484585091842208;7.403138728750311 -8.1171284297422197 -0.78663703310617572;3.2016921363205273 5.2067350495732772 -4.3042084323276981;1.0101823067339297 -4.9348476778512671 6.0843443424127681;-1.1742448479904906 8.6668519237033657 -3.8411409523363362;-5.4809570108141115 -3.6704084780410486 3.9785787769290368;7.4247639051267598 -3.2933409347621372 3.5683462726226427;5.9281321010107746 3.1992745271968461 -3.7383213511952897;17.393674891288036 -20.364881878385134 -0.80331835374854599;7.2613822483953783 -9.2680226081882164 0.37365006757221941;2.8477851113307824 3.622814167872654 -1.3645856585537666;-7.9312590291443765 -2.7973564572024494 1.3836235341121119;-2.637566023348457 7.9199582614175004 -4.0493006459991427;-6.1407265442946981 -2.788212744171024 3.4138714837307509;-2.0014798351923155 3.5734115297351416 -5.8628584625596636;1.9235813815449572 -3.645782581031408 6.7592414443181514;4.0887002179727476 -2.6745503920699898 -7.2182220804547654;5.5630096197608543 0.14216646747804426 -1.7480112528338521;-4.4595170723680564 1.0029787208725571 -4.7079692389512271;0.4310353885575357 5.941938809147624 6.0119946112445088;-7.4951267094060157 8.9192094667222612 -0.31491570039201583;-3.186076463326005 -4.8339258113331276 7.4196139249204407;-4.9152237003318833 8.2562135434915316 2.2477203916848829;0.99592875626290056 -1.9440548891391092 -9.2012315064797168;6.2118412750128256 -3.0743998257674234 -6.1493261117284499;-7.7702398895706652 5.414696548475824 -2.3411166967619228;8.8038833385275073 2.4062967312638501 1.7646847341651761;5.423424144464839 -5.2846651218194376 3.9188021771531378;6.0386664091732252 2.8579105190493457 4.8688003871994416;-0.84332063164589111 -4.2359583945522585 -0.45972278556338114;7.400151883779893 -3.5840422868879642 2.3264303995447984;4.0108239263240497 2.3394805507062482 7.8421884860333773;-7.4309288904435515 7.1516590662788557 1.7633365464831219;2.0972111217630607 1.5640720912560893 -7.7377689503153562;-5.1691366764641469 -0.94599249667975338 -4.7414247843444848;4.1062879335496794 -6.7996224255079625 5.2230289339000144;3.9882590761214383 4.9260904516906816 -1.5302519184360159;-7.2121750394124611 -1.5838855135854129 5.030739801167126;5.7807117083396431 -1.5924413258204186 -1.0653382731732846;6.0420738893969617 -2.8672777260059168 -3.7521264608745732;-6.0162831881236647 8.5555872601828877 0.94180525806121185;5.698581477113974 4.2208955452505812 3.3793572940386207;-5.0927208536224304 7.7888897977073066 -0.41514142844440022;0.012563640175616543 5.5094370170707707 -1.920022151731859;-4.0396508076780915 -4.5888800362405968 1.4256976316860277;1.5519440052807099 2.6129316301869308 -8.8293704806134556;6.4559003664969881 -4.0718034121281441 5.2744913683372818;7.3589844897697114 2.3222009548747953 -3.3052087459751966;-4.7999642017316315 1.2890969140570017 7.2655207709874929;-1.0597693265824997 6.1590005338845897 -7.2661863597861167;5.0305062643210166 4.6211717775427603 3.3276769462835767;5.3112529453414732 6.0529535665211043 -4.0425674123073705;7.1910404119140727 1.3198810752394055 -2.8031252812389802;-4.7362815089351216 -5.8126907251673829 -3.1682474890925771;-4.4101722912735095 -6.2508023187848867 -0.44603342729487211;3.8640911296325431 2.3875182911977224 7.5022188007710398;-1.8583812644856037 6.2364094118982925 2.4785012905198052;9.2403082040274995 -3.2216292406950857 -0.56159747019163464;-4.8966706034870882 -4.9433635944538343 -3.3169549419858777;-3.742180660965706 6.9621629576261403 6.0851438359279175;4.8237751179361137 -8.6495683318906629 -4.137332497387785;-1.1023117354994922 -3.7711587487813341 -0.98091921207692212;4.7128991422511071 -1.2763443011459898 -4.1613348805146178;-5.6009505816987879 3.931812051846443 -5.1257835926419792;3.5894874331686495 6.4771633266108575 -0.30935098090495355;2.1888590054712749 4.929225734864441 3.0549111014867458;5.145060454182814 -2.1918035616876979 6.1358732003745482;3.229308201580622 7.5294605553361542 -0.84080725967604597;3.0808889015253182 -8.8215273900922213 0.8706207976437188;-7.9254153161237308 4.8529704591568974 -0.24969670508909567;-7.3365756962021509 5.9096765772587885 2.8958916600720066;6.8029299471476703 1.3847758659397345 -1.9817648058380026;-1.8899886994866881 8.5153036861009213 4.7390902928376404;-0.68369120088634849 8.5057196298666007 -4.3760835048045701;2.6387472150111297 4.2595997529720595 5.0185799111906997;5.4844495474051147 -7.1821148083344157 2.4848053832756163;-4.6324255597365545 8.0186608935362802 -1.4413981613738303;9.4369011938282004 -7.9577824135543729 0.59551552375628947;5.2163029146514015 -7.5013931726875205 2.0869842331685486;10.177425252292512 -0.88823789544536913 0.0060898350538074603;-8.0927864376199352 5.57997371988239 1.862747655118292;2.6700910059604399 6.0277427087628022 4.2154900211768576;7.1743704987327899 -5.872750693027375 1.3733650056550333;0.38210651062481604 5.2083857960760875 -4.9578232455427864;4.7098952310402442 6.1991123736359111 -3.3756979673368877;-5.9208962541823649 7.2127953382767842 0.86885525650574447;-4.6993331486220624 5.4780936259157791 5.4044047394978509;0.050238529585326534 5.7374251662197553 -1.8061235666066831;-6.1189693564872947 7.0896790000672203 -0.36083398666415956;-3.7379185580563274 6.5827381985755995 5.9335663894046737;2.1243742685586282 -7.9892685068250264 -5.8343039007752626;-2.219917333224898 5.3350954803874941 -7.3437747024213484;4.439331374866585 4.6512251704678738 1.0837365210155709;2.0411004810233151 -2.7032811258496214 7.9234384821516617;7.6581535893790313 -5.3975930401076759 -0.24768158720245284;-1.5663915093455534 3.9234805783233035 -8.0724259612064309;6.3802967566697832 -6.2684971231985784 2.7946368732765192;6.2859848949526871 2.5558358851699592 4.8528060783498566;-6.007001262717937 -0.074957755496002934 -6.4400958729983389;1.8712792573352646 -8.8615475408717046 -5.0584866865048275;-4.197268846802463 -3.7176084285814541 4.8035316641353525;6.6501242716662103 -0.47027214543072965 5.4446819288395947;-2.3756046390691052 -5.6346664756652354 -5.2051704422097753;-5.9787613909418216 -4.0475523158523066 -4.2924861037787396;-6.7297906914611332 2.4885935685163831 -5.1551302380332293;-2.5839541007003652 4.978358676473567 -7.5855346300061663;6.734582507228005 0.39957804953312792 5.5556106550997484;-1.39247412564544 6.5561332978176861 -6.5508385323136755;7.2304954816181874 -0.17915900964713338 6.66570099818989;3.105390855404345 6.5759623683456105 3.0586656392284812;-6.6241536282067575 5.6391223226868155 -3.4633564738456908];
    
    % Layer 2
    b2 = -0.93910101996068251;
    LW2_1 = [0.0055054641605108215 -2.09445822677784 0.010720129090376585 -0.042199895139856954 2.6098431798434532 -3.4613274919593358 -0.023009588982498354 -2.7664806910615094 -0.041174325186237849 0.39766821634388799 -0.0016962986017457344 0.0043807046087179736 0.0056633219323380737 0.010725104334495795 -0.011347095416693704 -2.0525025382241826 0.0047316729173550271 -0.0022972912840000317 0.017306002853952184 0.0022730190889744747 0.0083710960998619258 0.00085919366045324164 0.030885676332072551 0.38281192568704331 -0.47763313267955715 0.0026814626033296297 -0.00036208271175833088 11.273538217588397 0.94217338738100465 -1.1973554918314215 -0.01050260964581032 -0.0061941671456541159 -0.93982593442041851 -0.0056723721802059961 0.0015414442140888704 -0.0673767658451426 -0.0053564320006764922 -0.0023375551404969924 -0.0062030588766561383 -0.55288856154288324 0.003631069046332135 -1.6638037612341288 0.0036730728386964273 -8.3926077976952644 9.2120922458051346 -0.0024830090431428422 -0.0042044632299858328 -3.7487974202731493 0.0014011577381091108 -0.0019409091714772705 -0.0018540416508875416 -0.0027301931071924668 -0.1730144893864681 0.003038607697802914 -0.0015087046678049435 -0.00018680703990537202 -0.0069465913334927432 3.162347531946756 -5.2171862851289585 0.00095270471837650473 -0.024849638663056405 0.00044622243423619358 -0.013108312734476525 -0.013494224586495383 -0.017753323909373914 -0.016260344264635334 -0.10352866629577688 -0.088863441929303233 -0.16507554841393726 0.0010742237460490585 0.0083970674116631561 0.0013505953667191691 0.035528652971329511 -0.0025946913166907093 0.12080410149798149 -0.61465658522703004 -0.0024962594112810394 -0.0018499362387647152 -0.0012892745612470215 -0.028705962134139118 -0.00019875365774971057 -0.00019071675259478874 -0.00082449741956962524 0.014039845443001553 -0.027833867190610002 0.0018333980631099109 0.0069386159440821852 0.0032677211550098573 0.71201211422113364 0.0036766341937403031 0.0032080690434410711 -0.009970086292940104 0.072660518402952887 0.00015674361718282862 -0.0042512127925046364 -0.0049181762338085964 7.0892162455337619e-05 -0.0011558260188748622 -0.0084752330846359306 -0.61236443518593309 0.0023802904921977068 0.87859961265597575 0.20803731203374198 0.0070000293278362361 -1.9836735063774137e-06 -0.00060286526263893746 0.00028128567166449582 0.0031017256405475287 0.0068951967400729267 -0.0040107278845173825 -0.017941929407167247 0.017238803961310906 0.00056795991015585817 0.046771964220725819 0.0019010936259502961 0.00066520232566517272 0.11726697529265379 0.0017807036738760299 0.46173707230244815 -0.0007732225938038744 0.00015264077865970903 3.2192766350699795 -0.0080369782657060598 -0.16464880696813036 -0.13032121219777171 -0.0017628219845395067 -0.0012562164297275559 -0.52252397389232264 -0.78062407538062828 0.0037659159349718468 0.0099584050054912759 0.0017742453923432662 0.1050537452041068 -0.010316318346099246 -0.00052414719455127752 -0.00019829961696483578 0.0045259628549044664 0.00027673098520415978 -0.0012856719016637651 -0.003174696513668189 0.094382161373363069 0.47870504448036694 0.046602037820204584 -0.0089479134164596342 -0.00024162771038553277 -0.019928942892651937 0.00026124660699964708 0.0035002917013447457 -0.0092849256879730079 0.0020178492580394942 -0.0057202143569501816 0.089407928439827977 -2.1206798589677547 -0.0050713951775092844 -0.0009289955145043488 0.0011823394804280068 -0.099938598634435646 -0.00080359411008680548 0.0009781883703543358 0.015425144153375666 -0.20745820356625969 -0.0034374589680340531 -0.0054838696697880468 -0.00051464702104679432 -0.032496388578121753 -0.070267516391774726 -0.038444994362507728 -0.18925773805486121 1.2219683677903566 -0.14514576241054336 -0.048173755209493282 0.20103220044225639 -1.1120508419707988 -1.2467281679237983 -0.056036856450756532 0.0026675216123724704 0.0041662741141328544 -1.5284927491275431 0.060760972933564708 0.22963504618099731 -4.0136930692235859 0.016021545056706325 -0.0034277454694066536 0.018388985554294798 0.97649460930723131 0.026049043836542499 7.0991310333662234 -0.00046554016264656442 -4.7432348833812998 -0.013104876043032707 -9.0725784450606533 -0.0091025070882414447 0.21637249980814816 -0.28663755762097887 -0.0047178096177814405 -0.0012288540157646215 0.0082184963001869869 7.2022317366987281 0.63459520515309509 0.048267060269041699 -0.00045963596187848188 -0.38126602445271268 -0.011033737189065008 -0.078484585613287278 0.055314434698090109 0.00073550959324885138 0.026583087710604341 -0.015471205310374148 -0.0017376595196214996 -5.033086394008607 0.00042602561216118721 4.4365874126942613 -0.00023541717457432491 -1.4441041927544803e-05 -0.017130382600442029 3.6531636489024172e-05 0.96350506632603472 0.0035377776120919632 -0.071177994473518719 0.0072415587444278357 0.0014282870177265391 1.8034297851090135 0.0001546260740672494 -0.0077321718720399441 -0.69527458937575204 0.011344100841967629 -5.0939379843581679e-05 -0.84460012404086571 -0.0087111413395329872 -3.2149486174906321 0.00223458695990274 0.92550590224450913 -2.1634303584669676 -0.0085108723396048035 0.01782902547241207 -0.0028705783180858558 0.0026242907605229923 0.00087629784283735075 -1.2347437764815237 0.0058995077250538919 -0.0011121232517422803 0.0043009615990736629 -0.0077703787528864048 -0.0051213150456111732 -0.0028546617922362997 -0.14478160819922509 0.29440618370556071 -0.013422131675682769 0.16602258517460095 2.2591345059452781 -0.071098189578433738 0.0162227703449003 0.48094068214727975 0.006587902478863995 0.010311058567354012 -0.0090882496098546681 0.0023355070856971921 -1.0100879961748122 0.10299885998906363 -0.31060336288356155 0.0030726030855247979 0.54026839997702247 0.62163846040299242 0.018776414918247747 0.36714768620697336 -0.050160295792198321 -1.2231699082213332 0.59639796478184381 0.0020376478297607029 -1.4250129301284928 0.0099277991929025179 -1.1063128290618476 -0.0022859405529013967 0.00097237202379317554 -0.77092022943660166 0.20010028033255015 1.1237078804999674 1.0024169999562222 1.2002742407028839 1.8206203160913443 0.28409110442950725 0.0091632716885012445 0.30409441723157793 -0.037801771105151469 -0.17875146240502343 -0.75146626066854705 0.015511964508222604 0.01027291691366837 0.28777150652972022 -0.0019229782170689614 0.018523220412426669 -0.0082376193356568615 -0.01350357067208352 0.031242597192621884 -0.68759981547270532 0.029479238219322641 0.33505543549122874 -0.015104308160063707 -0.0043716837261878437 0.75620872160219099];
    
    % Output 1
    y1_step1_ymin = -1;
    y1_step1_gain = 0.015891213033636;
    y1_step1_xoffset = 22.938756978207;
    
    % ===== SIMULATION ========
    
    % Dimensions
    Q = size(x1,2); % samples
    
    % Input 1
    xp1 = mapminmax_apply(x1,x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Tm = mapminmax_reverse(a2,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin) + 273.15;
% Tm = -1;
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
